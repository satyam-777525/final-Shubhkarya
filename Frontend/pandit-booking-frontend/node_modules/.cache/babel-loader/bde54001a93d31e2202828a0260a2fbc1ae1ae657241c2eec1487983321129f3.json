{"ast":null,"code":"// src/pages/DevoteesPage.jsx\nimport React,{useEffect,useState}from'react';import{getAllDevotees}from'../api/api';import'./DevoteesPage.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function DevoteesPage(){const[devotees,setDevotees]=useState([]);const[expandedId,setExpandedId]=useState(null);const[editForm,setEditForm]=useState({});const[filters,setFilters]=useState({name:'',city:''});useEffect(()=>{fetchDevotees();},[]);async function fetchDevotees(){try{const res=await getAllDevotees();setDevotees(res.data);}catch(e){console.error(e);}}async function handleSave(id){try{const{name,email,...rest}=editForm[id];await fetch(`https://localhost:5000/api/users/update/${id}`,{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify(rest)});setExpandedId(null);fetchDevotees();}catch(err){console.error(err);}}function handleChange(id,field,value){setEditForm(prev=>({...prev,[id]:{...prev[id],[field]:value}}));}// Filter devotees\nconst filtered=devotees.filter(d=>{if(filters.name&&!d.name.toLowerCase().includes(filters.name.toLowerCase()))return false;if(filters.city&&!(d.city&&d.city.toLowerCase().includes(filters.city.toLowerCase())))return false;return true;});return/*#__PURE__*/_jsxs(\"div\",{className:\"devotees-page\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Devotees List\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"devotees-filters\",children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"Search by Name\",value:filters.name,onChange:e=>setFilters(f=>({...f,name:e.target.value})),\"aria-label\":\"Filter devotees by name\"}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"Filter by City\",value:filters.city,onChange:e=>setFilters(f=>({...f,city:e.target.value})),\"aria-label\":\"Filter devotees by city\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setFilters({name:'',city:''}),\"aria-label\":\"Clear Filters\",children:\"Clear Filters\"})]}),filtered.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No devotees found.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"devotees-cards-grid\",children:filtered.map(d=>{const isExpanded=expandedId===d._id;const form=editForm[d._id]||d;return/*#__PURE__*/_jsx(\"div\",{className:`devotee-card ${isExpanded?'expanded':''}`,role:\"button\",tabIndex:0,onClick:()=>setExpandedId(isExpanded?null:d._id),onKeyDown:e=>{if(e.key==='Enter'||e.key===' '){setExpandedId(isExpanded?null:d._id);}},\"aria-expanded\":isExpanded,\"aria-label\":`Devotee card for ${d.name}`,children:!isExpanded?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"strong\",{children:d.name})}),/*#__PURE__*/_jsx(\"p\",{children:d.email})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"devotee-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Name:\"}),/*#__PURE__*/_jsx(\"input\",{value:form.name,disabled:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"devotee-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email:\"}),/*#__PURE__*/_jsx(\"input\",{value:form.email,disabled:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"devotee-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Phone:\"}),/*#__PURE__*/_jsx(\"input\",{value:form.phone||'',onChange:e=>handleChange(d._id,'phone',e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"devotee-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"City:\"}),/*#__PURE__*/_jsx(\"input\",{value:form.city||'',onChange:e=>handleChange(d._id,'city',e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"devotee-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Address:\"}),/*#__PURE__*/_jsx(\"input\",{value:form.address||'',onChange:e=>handleChange(d._id,'address',e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"devotee-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();handleSave(d._id);},\"aria-label\":`Save changes for ${d.name}`,children:\"Save\"}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();setExpandedId(null);},\"aria-label\":`Cancel changes for ${d.name}`,children:\"Cancel\"})]})]})},d._id);})})]});}export default DevoteesPage;","map":{"version":3,"names":["React","useEffect","useState","getAllDevotees","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","DevoteesPage","devotees","setDevotees","expandedId","setExpandedId","editForm","setEditForm","filters","setFilters","name","city","fetchDevotees","res","data","e","console","error","handleSave","id","email","rest","fetch","method","headers","body","JSON","stringify","err","handleChange","field","value","prev","filtered","filter","d","toLowerCase","includes","className","children","placeholder","onChange","f","target","onClick","length","map","isExpanded","_id","form","role","tabIndex","onKeyDown","key","disabled","phone","address","stopPropagation"],"sources":["C:/Users/sv106/OneDrive/Desktop/Shubhkarya/Frontend/pandit-booking-frontend/src/pages/DevoteesPage.jsx"],"sourcesContent":["// src/pages/DevoteesPage.jsx\r\nimport React, { useEffect, useState } from 'react';\r\nimport { getAllDevotees } from '../api/api';\r\nimport './DevoteesPage.css';\r\n\r\nfunction DevoteesPage() {\r\n  const [devotees, setDevotees] = useState([]);\r\n  const [expandedId, setExpandedId] = useState(null);\r\n  const [editForm, setEditForm] = useState({});\r\n  const [filters, setFilters] = useState({ name: '', city: '' });\r\n\r\n  useEffect(() => {\r\n    fetchDevotees();\r\n  }, []);\r\n\r\n  async function fetchDevotees() {\r\n    try {\r\n      const res = await getAllDevotees();\r\n      setDevotees(res.data);\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n  }\r\n\r\n  async function handleSave(id) {\r\n    try {\r\n      const { name, email, ...rest } = editForm[id];\r\n      await fetch(`https://localhost:5000/api/users/update/${id}`, {\r\n        method: 'PUT',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(rest),\r\n      });\r\n      setExpandedId(null);\r\n      fetchDevotees();\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  }\r\n\r\n  function handleChange(id, field, value) {\r\n    setEditForm(prev => ({\r\n      ...prev,\r\n      [id]: { ...prev[id], [field]: value },\r\n    }));\r\n  }\r\n\r\n  // Filter devotees\r\n  const filtered = devotees.filter(d => {\r\n    if (filters.name && !d.name.toLowerCase().includes(filters.name.toLowerCase())) return false;\r\n    if (filters.city && !(d.city && d.city.toLowerCase().includes(filters.city.toLowerCase()))) return false;\r\n    return true;\r\n  });\r\n\r\n  return (\r\n    <div className=\"devotees-page\">\r\n      <h2>Devotees List</h2>\r\n\r\n      <div className=\"devotees-filters\">\r\n        <input\r\n          placeholder=\"Search by Name\"\r\n          value={filters.name}\r\n          onChange={e => setFilters(f => ({ ...f, name: e.target.value }))}\r\n          aria-label=\"Filter devotees by name\"\r\n        />\r\n        <input\r\n          placeholder=\"Filter by City\"\r\n          value={filters.city}\r\n          onChange={e => setFilters(f => ({ ...f, city: e.target.value }))}\r\n          aria-label=\"Filter devotees by city\"\r\n        />\r\n        <button onClick={() => setFilters({ name: '', city: '' })} aria-label=\"Clear Filters\">Clear Filters</button>\r\n      </div>\r\n\r\n      {filtered.length === 0 ? (\r\n        <p>No devotees found.</p>\r\n      ) : (\r\n        <div className=\"devotees-cards-grid\">\r\n          {filtered.map(d => {\r\n            const isExpanded = expandedId === d._id;\r\n            const form = editForm[d._id] || d;\r\n            return (\r\n              <div\r\n                key={d._id}\r\n                className={`devotee-card ${isExpanded ? 'expanded' : ''}`}\r\n                role=\"button\"\r\n                tabIndex={0}\r\n                onClick={() => setExpandedId(isExpanded ? null : d._id)}\r\n                onKeyDown={e => {\r\n                  if (e.key === 'Enter' || e.key === ' ') {\r\n                    setExpandedId(isExpanded ? null : d._id);\r\n                  }\r\n                }}\r\n                aria-expanded={isExpanded}\r\n                aria-label={`Devotee card for ${d.name}`}\r\n              >\r\n                {!isExpanded ? (\r\n                  <>\r\n                    <p><strong>{d.name}</strong></p>\r\n                    <p>{d.email}</p>\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <div className=\"devotee-field\">\r\n                      <label>Name:</label>\r\n                      <input value={form.name} disabled />\r\n                    </div>\r\n                    <div className=\"devotee-field\">\r\n                      <label>Email:</label>\r\n                      <input value={form.email} disabled />\r\n                    </div>\r\n                    <div className=\"devotee-field\">\r\n                      <label>Phone:</label>\r\n                      <input\r\n                        value={form.phone || ''}\r\n                        onChange={e => handleChange(d._id, 'phone', e.target.value)}\r\n                      />\r\n                    </div>\r\n                    <div className=\"devotee-field\">\r\n                      <label>City:</label>\r\n                      <input\r\n                        value={form.city || ''}\r\n                        onChange={e => handleChange(d._id, 'city', e.target.value)}\r\n                      />\r\n                    </div>\r\n                    <div className=\"devotee-field\">\r\n                      <label>Address:</label>\r\n                      <input\r\n                        value={form.address || ''}\r\n                        onChange={e => handleChange(d._id, 'address', e.target.value)}\r\n                      />\r\n                    </div>\r\n                    <div className=\"devotee-actions\">\r\n                      <button\r\n                        onClick={e => {\r\n                          e.stopPropagation();\r\n                          handleSave(d._id);\r\n                        }}\r\n                        aria-label={`Save changes for ${d.name}`}\r\n                      >\r\n                        Save\r\n                      </button>\r\n                      <button\r\n                        onClick={e => {\r\n                          e.stopPropagation();\r\n                          setExpandedId(null);\r\n                        }}\r\n                        aria-label={`Cancel changes for ${d.name}`}\r\n                      >\r\n                        Cancel\r\n                      </button>\r\n                    </div>\r\n                  </>\r\n                )}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default DevoteesPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}